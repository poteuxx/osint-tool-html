<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>OSINT Master — Advanced Quick Search</title>
<style>
  :root{
    --bg:#0b0b0c; --panel:#121214; --muted:#9aa3ad; --accent:#1db954; --glass:rgba(255,255,255,0.03);
    --glass-2:rgba(255,255,255,0.02);
  }
  html,body{height:100%;}
  body{
    margin:0; font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background:linear-gradient(180deg,var(--bg),#050506); color:#e6eef1; padding:28px; display:flex; gap:20px; align-items:flex-start; justify-content:center;
  }
  .app{width:1100px; max-width:100%; display:grid; grid-template-columns: 1fr 380px; gap:18px;}
  .card{background:linear-gradient(180deg,var(--panel),#0f1011); border-radius:12px; padding:16px; box-shadow:0 6px 30px rgba(0,0,0,0.6);} 
  header.card{grid-column:1/-1; display:flex; align-items:center; gap:16px;}
  h1{margin:0;font-size:20px;color:var(--accent);} .sub{color:var(--muted); font-size:13px}

  .main{min-height:520px}
  .controls{display:flex; gap:10px; align-items:center; margin-bottom:12px}
  input[type=text], input[type=password], select{background:var(--glass); border:1px solid rgba(255,255,255,0.03); color:inherit; padding:10px 12px; border-radius:8px; outline:none}
  input[type=checkbox]{transform:scale(1.05)}
  button{background:var(--accent); color:#021; border:none; padding:10px 12px; border-radius:8px; cursor:pointer}
  button.ghost{background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted)}

  .engines{display:flex; flex-wrap:wrap; gap:8px}
  .engine{padding:8px 10px; border-radius:8px; background:var(--glass-2); font-size:13px; color:var(--muted); cursor:pointer}
  .engine.selected{outline:2px solid rgba(29,185,84,0.12); color:var(--accent)}

  .results{margin-top:12px; display:flex; flex-direction:column; gap:8px}
  .result-row{display:flex; justify-content:space-between; gap:8px; align-items:center; padding:10px; border-radius:8px; background:rgba(255,255,255,0.016)}
  .result-row .meta{color:var(--muted); font-size:13px}
  .small{font-size:12px;color:var(--muted)}
  textarea{width:100%; min-height:100px; background:transparent; border:1px dashed rgba(255,255,255,0.03); padding:10px;border-radius:8px}

  .side{position:relative}
  .group{margin-top:12px}
  .flex{display:flex; gap:8px}
  .history-list{max-height:260px; overflow:auto; display:flex; flex-direction:column; gap:6px; margin-top:8px}
  .chip{padding:8px;border-radius:8px;background:rgba(255,255,255,0.02); cursor:pointer}
  footer{grid-column:1/-1; color:var(--muted); font-size:12px; text-align:center; margin-top:6px}

  .counts{font-weight:600; color:#fff}
  .danger{color:#ff6b6b}

  /* responsive */
  @media (max-width:1050px){ .app{grid-template-columns:1fr; } .side{order:2} }
</style>
</head>
<body>
  <div class="app">
    <header class="card">
      <div style="flex:1">
        <h1>OSINT Master — Advanced Quick Search</h1>
        <div class="sub">Precise, batch and API-backed counting. Use Bing/Google API keys to get accurate web counts (optional).</div>
      </div>
      <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
        <div class="small">Mode: <strong id="modeLabel">Exact</strong></div>
        <div style="display:flex;gap:8px"><button id="openAllBtn">Open All</button><button class="ghost" id="exportBtn">Export CSV</button></div>
      </div>
    </header>

    <section class="card main">
      <div class="controls">
        <input id="query" type="text" placeholder='Enter username, domain, IP, or phrase (use quotes for exact)'>
        <select id="preset">
          <option value="">— Presets —</option>
          <option value="^username">Username (exact)</option>
          <option value="^domain">Domain (site:)</option>
          <option value="^ip">IP (shodan)</option>
        </select>
        <label class="small"><input type="checkbox" id="exactToggle" checked> Exact match</label>
        <button id="searchBtn">Search</button>
        <button id="countBtn">Count</button>
      </div>

      <div class="card" style="padding:12px">
        <div class="small">Select sources (click to toggle). Hold <kbd>Shift</kbd> to multi-select quickly.</div>
        <div id="engines" class="engines"></div>
        <div class="results" id="results"></div>
      </div>

      <div class="group card">
        <div class="small">Advanced query builder</div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <input id="op_site" type="text" placeholder="site:example.com (optional)">
          <input id="op_filetype" type="text" placeholder="filetype:pdf">
          <input id="op_before" type="text" placeholder="before:YYYY-MM-DD">
        </div>
        <div style="margin-top:10px;display:flex;gap:8px">
          <button id="applyOps" class="ghost">Apply to query</button>
          <button id="permuteBtn" class="ghost">Generate permutations</button>
          <button id="batchBtn" class="ghost">Batch from list</button>
        </div>
        <textarea id="batchInput" placeholder="Paste newline-separated strings here for batch operations (optional)"></textarea>
      </div>

      <div class="group card">
        <div class="small">Quick site-count (client-side best-effort) — scans specific public sites for matches and returns counts found on those sites only.</div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <label><input type="checkbox" id="scanGithub"> GitHub</label>
          <label><input type="checkbox" id="scanReddit"> Reddit</label>
          <label><input type="checkbox" id="scanTwitter"> X (Twitter)</label>
          <label><input type="checkbox" id="scanShodan"> Shodan</label>
        </div>
        <div class="small" style="margin-top:8px">Note: site scans open search pages for you and attempt to parse counts with APIs when available.</div>
      </div>
    </section>

    <aside class="card side">
      <div>
        <div class="small">API keys (optional — required for accurate global counts)</div>
        <input id="bingKey" type="password" placeholder="Bing (Azure) API key" />
        <input id="googleKey" type="password" placeholder="Google Custom Search API key" />
        <input id="googleCx" type="text" placeholder="Google CSE cx (search engine id)" />
        <div class="small" style="margin-top:8px">When you click Count, the tool will use these keys (if present) to fetch accurate total matches from search APIs.</div>
      </div>

      <div class="group">
        <div class="small">History</div>
        <div id="history" class="history-list"></div>
      </div>

      <div class="group">
        <div class="small">Saved permutations</div>
        <div id="perms" class="history-list"></div>
      </div>

      <div class="group">
        <div class="small">Tips</div>
        <ul class="small">
          <li>Use quotes for exact phrase: "john.doe"</li>
          <li>Try site:example.com or filetype:pdf in advanced ops</li>
          <li>Provide Bing API key (Azure Cognitive Services) to get totalEstimatedMatches</li>
        </ul>
      </div>
    </aside>

    <footer>OSINT Master — client-only demo. For precise global counts you must provide API keys (Bing/Google). Use responsibly.</footer>
  </div>

<script>
// --- engine list ---
const ENGINES = [
  {id:'google',name:'Google',url:'https://www.google.com/search?q='},
  {id:'bing',name:'Bing',url:'https://www.bing.com/search?q='},
  {id:'ddg',name:'DuckDuckGo',url:'https://duckduckgo.com/?q='},
  {id:'github',name:'GitHub',url:'https://github.com/search?q='},
  {id:'reddit',name:'Reddit',url:'https://www.reddit.com/search/?q='},
  {id:'x',name:'X (Twitter)',url:'https://x.com/search?q='},
  {id:'shodan',name:'Shodan',url:'https://www.shodan.io/search?query='},
  {id:'censys',name:'Censys',url:'https://search.censys.io/search?q='},
  {id:'virustotal',name:'VirusTotal',url:'https://www.virustotal.com/gui/search/'},
];

const enginesEl = document.getElementById('engines');
const resultsEl = document.getElementById('results');
const historyEl = document.getElementById('history');
const permsEl = document.getElementById('perms');

let selected = new Set(['google','bing','ddg']);
let history = [];

function renderEngines(){
  enginesEl.innerHTML='';
  ENGINES.forEach(e=>{
    const el = document.createElement('div'); el.className='engine' + (selected.has(e.id)?' selected':''); el.textContent=e.name; el.dataset.id=e.id;
    el.addEventListener('click',(ev)=>{
      if(ev.shiftKey){ // multi-select shift
        if(selected.has(e.id)) selected.delete(e.id); else selected.add(e.id);
      } else {
        // single-select toggle
        if(selected.has(e.id) && selected.size>1) { selected.delete(e.id); } else { selected = new Set([e.id]); }
      }
      renderEngines();
    });
    enginesEl.appendChild(el);
  });
}
renderEngines();

function addHistory(q){ history.unshift({q,ts:Date.now()}); if(history.length>50) history.pop(); renderHistory(); }
function renderHistory(){ historyEl.innerHTML=''; history.forEach(h=>{ const d=document.createElement('div'); d.className='chip'; d.textContent=h.q; d.addEventListener('click',()=>{ document.getElementById('query').value=h.q; }); historyEl.appendChild(d); }); }

// search & open
function buildQuery(q){
  const exact = document.getElementById('exactToggle').checked;
  const ops = [];
  const site = document.getElementById('op_site').value.trim(); if(site) ops.push(site);
  const filetype = document.getElementById('op_filetype').value.trim(); if(filetype) ops.push('filetype:'+filetype);
  const before = document.getElementById('op_before').value.trim(); if(before) ops.push('before:'+before);
  let base = q.trim();
  if(exact && !/^".*"$/.test(base)) base = '"'+base+'"';
  return [base].concat(ops).join(' ');
}

function searchAll(){
  const qRaw = document.getElementById('query').value.trim(); if(!qRaw) return alert('Please enter a search term');
  const q = buildQuery(qRaw);
  addHistory(qRaw);
  resultsEl.innerHTML='';
  ENGINES.forEach(e=>{ if(selected.has(e.id)){ const row=document.createElement('div'); row.className='result-row'; const a=document.createElement('a'); a.href=e.url + encodeURIComponent(q); a.target='_blank'; a.textContent='Search ' + e.name; const meta=document.createElement('div'); meta.className='meta'; meta.innerHTML=`<span class="small">${e.id}</span>`; row.appendChild(a); row.appendChild(meta); resultsEl.appendChild(row); }});
}

// open all selected in new tabs
document.getElementById('openAllBtn').addEventListener('click',()=>{
  const qRaw = document.getElementById('query').value.trim(); if(!qRaw) return alert('Enter search term');
  const q = buildQuery(qRaw);
  ENGINES.forEach(e=>{ if(selected.has(e.id)){ window.open(e.url + encodeURIComponent(q),'_blank'); }});
});

// export CSV
document.getElementById('exportBtn').addEventListener('click',()=>{
  const q = document.getElementById('query').value.trim(); if(!q) return alert('No query');
  const rows = [['engine','url']]; ENGINES.forEach(e=>{ if(selected.has(e.id)) rows.push([e.name, e.url + encodeURIComponent(buildQuery(q))]); });
  const csv = rows.map(r=>r.map(c=>'"'+String(c).replace(/"/g,'""')+'"').join(',')).join('\n');
  const blob = new Blob([csv],{type:'text/csv'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='osint-search.csv'; a.click(); URL.revokeObjectURL(url);
});

// apply advanced ops
document.getElementById('applyOps').addEventListener('click',()=>{ const q=document.getElementById('query').value.trim(); document.getElementById('query').value = buildQuery(q); });

// permutations
function permutationsOf(s){ // naive: split words and produce order variants
  const words = s.split(/\s+/).filter(Boolean);
  if(words.length<=1) return [s];
  // limit permutations to 24
  const perms = [];
  function perm(a, l){ if(l===a.length){ perms.push(a.join(' ')); return; } for(let i=l;i<a.length;i++){ [a[l],a[i]]=[a[i],a[l]]; perm(a,l+1); [a[l],a[i]]=[a[i],a[l]]; }}
  perm(words.slice(),0);
  return Array.from(new Set(perms)).slice(0,24);
}

document.getElementById('permuteBtn').addEventListener('click',()=>{
  const q=document.getElementById('query').value.trim(); if(!q) return alert('Enter a query');
  const list = permutationsOf(q);
  permsEl.innerHTML=''; list.forEach(p=>{ const d=document.createElement('div'); d.className='chip'; d.textContent=p; d.addEventListener('click',()=>{ document.getElementById('query').value=p; }); permsEl.appendChild(d); });
});

// batch
document.getElementById('batchBtn').addEventListener('click',()=>{
  const txt=document.getElementById('batchInput').value.trim(); if(!txt) return alert('Paste list in batch input');
  const items = txt.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
  // open first 10 to avoid popup spam
  items.slice(0,10).forEach(it=>{ document.getElementById('query').value = it; searchAll(); });
  alert('Batch processed: opened up to 10 items in new tabs / prepared results.');
});

// Counting
async function countMatches(){
  const qRaw = document.getElementById('query').value.trim(); if(!qRaw) return alert('Enter query');
  const q = buildQuery(qRaw);
  resultsEl.innerHTML='';
  addHistory(qRaw);

  // show placeholder rows
  const rows = [];
  ENGINES.forEach(e=>{ if(selected.has(e.id)){ const row=document.createElement('div'); row.className='result-row'; row.innerHTML = `<div>${e.name}</div><div class="meta">Checking…</div>`; resultsEl.appendChild(row); rows.push({engine:e,el:row}); }});

  // First: if user provided Bing key, call Bing Web Search API for accurate totalEstimatedMatches
  const bingKey = document.getElementById('bingKey').value.trim();
  if(bingKey){
    try{
      const resp = await fetch('https://api.bing.microsoft.com/v7.0/search?q=' + encodeURIComponent(q), {headers:{'Ocp-Apim-Subscription-Key': bingKey}});
      if(resp.ok){ const j=await resp.json(); const n = (j.webPages && j.webPages.totalEstimatedMatches) ? j.webPages.totalEstimatedMatches : null;
        // display for Bing row if present
        rows.forEach(r=>{ if(r.engine.id==='bing') r.el.querySelector('.meta').textContent = n!==null ? '≈ '+Number(n).toLocaleString()+' results (Bing API)' : 'No count'; });
      } else {
        rows.forEach(r=>{ if(r.engine.id==='bing') r.el.querySelector('.meta').textContent = 'Bing API error: '+resp.status; });
      }
    }catch(err){ rows.forEach(r=>{ if(r.engine.id==='bing') r.el.querySelector('.meta').textContent = 'Bing call failed'; }); }
  } // end bing

  // Google Custom Search (requires key + cx)
  const gKey = document.getElementById('googleKey').value.trim();
  const gCx = document.getElementById('googleCx').value.trim();
  if(gKey && gCx){
    try{
      const resp = await fetch('https://www.googleapis.com/customsearch/v1?key='+encodeURIComponent(gKey)+'&cx='+encodeURIComponent(gCx)+'&q='+encodeURIComponent(q));
      if(resp.ok){ const j=await resp.json(); const n = (j.searchInformation && j.searchInformation.totalResults) ? j.searchInformation.totalResults : null;
        rows.forEach(r=>{ if(r.engine.id==='google') r.el.querySelector('.meta').textContent = n!==null ? '≈ '+Number(n).toLocaleString()+ ' results (Google CSE)' : 'No count'; });
      } else { rows.forEach(r=>{ if(r.engine.id==='google') r.el.querySelector('.meta').textContent = 'Google API error: '+resp.status; }); }
    }catch(e){ rows.forEach(r=>{ if(r.engine.id==='google') r.el.querySelector('.meta').textContent = 'Google call failed'; }); }
  }

  // Site-specific attempts: GitHub search API (unauthenticated has rate limits)
  if(document.getElementById('scanGithub').checked){
    try{
      const resp = await fetch('https://api.github.com/search/code?q='+encodeURIComponent(q));
      if(resp.ok){ const j=await resp.json(); const n=j.total_count; // may be capped
        rows.forEach(r=>{ if(r.engine.id==='github') r.el.querySelector('.meta').textContent = n!==undefined ? n+' hits (GitHub API)' : 'No count'; });
      } else { rows.forEach(r=>{ if(r.engine.id==='github') r.el.querySelector('.meta').textContent = 'GitHub API err '+resp.status; }); }
    }catch(e){ rows.forEach(r=>{ if(r.engine.id==='github') r.el.querySelector('.meta').textContent = 'GitHub call failed'; }); }
  }

  // For other engines where no API key is provided, we cannot fetch counts due to CORS / scraping restrictions from the browser.
  rows.forEach(r=>{ if(!r.el.querySelector('.meta').textContent || r.el.querySelector('.meta').textContent==='Checking…') r.el.querySelector('.meta').textContent = 'Count unavailable (provide API key or open search)'; });
}

document.getElementById('countBtn').addEventListener('click',countMatches);

</script>
</body>
</html>
